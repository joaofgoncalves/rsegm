<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute per-segment band means from tiled segmentations — segment_means_from_tiles • rsegm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute per-segment band means from tiled segmentations — segment_means_from_tiles"><meta name="description" content="Computes mean spectral values for a set of segment IDs by iterating over
segmentation tiles stored on disk and streaming values from the original
image raster. This function avoids virtual raster (VRT) reads and is designed
for memory-safe processing of large images."><meta property="og:description" content="Computes mean spectral values for a set of segment IDs by iterating over
segmentation tiles stored on disk and streaming values from the original
image raster. This function avoids virtual raster (VRT) reads and is designed
for memory-safe processing of large images."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rsegm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tiled-segmentation-workflow.html">Tiled segmentation workflow</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joaofgoncalves/rsegm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute per-segment band means from tiled segmentations</h1>
      <small class="dont-index">Source: <a href="https://github.com/joaofgoncalves/rsegm/blob/HEAD/R/tile_engine.R" class="external-link"><code>R/tile_engine.R</code></a></small>
      <div class="d-none name"><code>segment_means_from_tiles.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes mean spectral values for a set of segment IDs by iterating over
segmentation tiles stored on disk and streaming values from the original
image raster. This function avoids virtual raster (VRT) reads and is designed
for memory-safe processing of large images.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">segment_means_from_tiles</span><span class="op">(</span><span class="va">img</span>, <span class="va">seg_tile_files</span>, <span class="va">ids</span>, block_nrows <span class="op">=</span> <span class="fl">512</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-img">img<a class="anchor" aria-label="anchor" href="#arg-img"></a></dt>
<dd><p>A `SpatRaster` containing the original multi-band image data.</p></dd>


<dt id="arg-seg-tile-files">seg_tile_files<a class="anchor" aria-label="anchor" href="#arg-seg-tile-files"></a></dt>
<dd><p>Character vector of file paths to segmentation tiles
(e.g., produced by [make_tiles_disk()]).</p></dd>


<dt id="arg-ids">ids<a class="anchor" aria-label="anchor" href="#arg-ids"></a></dt>
<dd><p>Integer vector of segment IDs for which means should be computed.</p></dd>


<dt id="arg-block-nrows">block_nrows<a class="anchor" aria-label="anchor" href="#arg-block-nrows"></a></dt>
<dd><p>Integer. Number of raster rows to process per read block
when streaming values from disk.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric matrix with `length(ids)` rows and `nlyr(img)` columns.
  Rows correspond to segment IDs (in the order of `ids`), and columns
  correspond to image bands. Segments with no contributing pixels return
  `NA` values.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each segmentation tile, the corresponding spatial subset of `img` is
cropped and read in row blocks. If grid geometry differs between the image
and a tile, the image subset is resampled to the tile grid before streaming.</p>
<p>Accumulation is performed as sums and pixel counts per segment, followed by
normalization to means. Segment labels with `NA` values are ignored.</p>
<p>This function is typically used after tiled segmentation and ID reconciliation
to compute region statistics without loading full rasters into memory.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rspatial.github.io/terra/reference/readwrite.html" class="external-link">readValues</a></code>, <code><a href="https://rspatial.github.io/terra/reference/crop.html" class="external-link">crop</a></code>,
<code><a href="https://rspatial.github.io/terra/reference/resample.html" class="external-link">resample</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by João Gonçalves.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>


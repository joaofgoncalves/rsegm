% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seeds_segmenter.R
\name{seeds_segmenter}
\alias{seeds_segmenter}
\title{SEEDS superpixel segmentation}
\usage{
seeds_segmenter(
  x,
  step = 10L,
  nbins = 20L,
  block_sizes = c(8L, 4L, 2L, 1L),
  iters_per_level = 5L,
  boundary_samples = 8L,
  alpha = 1,
  smooth = 0L,
  output_file = NULL,
  verbose = FALSE
)
}
\arguments{
\item{x}{A \code{\link[terra:SpatRaster-class]{SpatRaster}} with \eqn{\ge 1}
layer (band).}

\item{step}{Integer \eqn{\ge 1}. Approximate initial superpixel spacing in
pixels. Larger values produce fewer (larger) superpixels. Internally this
sets the size of the initial grid cells used to initialize labels.}

\item{nbins}{Integer \eqn{\ge 2}. Number of histogram bins per band. Pixel
values are quantized per band based on that band's min/max (computed
ignoring \code{NA}/NaN).}

\item{block_sizes}{Integer vector of hierarchical block sizes (coarse-to-fine),
e.g. \code{c(8,4,2,1)}. At each level, candidate moves are proposed over
aligned \code{bs x bs} blocks, refining boundaries progressively.}

\item{iters_per_level}{Integer \eqn{\ge 1}. Number of refinement iterations
per hierarchy level in \code{block_sizes}.}

\item{boundary_samples}{Integer \eqn{\ge 1}. Sampling effort knob controlling
how many boundary-proposal samples are evaluated per iteration.
Internally the C++ routine scales the number of samples roughly with the
number of labels (\code{K}) and caps it for safety.}

\item{alpha}{Non-negative numeric. Additive smoothing constant for histogram
probabilities (Laplace-like smoothing). Higher values reduce sensitivity to
small counts and can stabilize results.}

\item{smooth}{Integer \eqn{\ge 0}. Optional mean filter window size (pixels)
applied to the raster prior to mean-shift. If \code{0} (default), no
pre-smoothing is applied. If \code{> 0}, a \code{smooth x smooth} mean
filter is applied via \code{\link[terra:focal]{terra::focal()}}.}

\item{output_file}{Optional character string. If provided, the resulting
segmentation raster is written to this file via
\code{\link[terra:writeRaster]{terra::writeRaster()}}.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages from the R
wrapper and allows the C++ routine to check for user interrupts during the
refinement loop. If \code{FALSE}, runs quietly.}
}
\value{
A single-layer \code{\link[terra:SpatRaster-class]{SpatRaster}} with
  integer superpixel IDs in a layer named \code{"seeds"}.
}
\description{
Generates **superpixels** using a SEEDS-like hierarchical approach based on
fast **histogram block moves**. The method starts from a regular grid of
initial labels and iteratively refines boundaries by proposing block-wise
label changes that improve a histogram-based objective.
}
\details{
This wrapper is intended to be **tile-friendly** (fast, local updates) and
can be used inside tiling strategies for large rasters.


**Implementation notes (C++):**
\itemize{
  \item \strong{Quantization:} each band is quantized into \code{nbins} using
  per-band min/max computed over finite values. NaN values are quantized to
  \code{-1} and ignored in histogram updates.
  \item \strong{Initialization:} labels are initialized as a regular grid
  with cell size \code{step} (in pixels). Labels start as \code{0..K-1} in C++,
  and are returned to R as \code{1..K}.
  \item \strong{Moves:} at each hierarchy level, the algorithm samples boundary
  pixels, finds a 4-neighbour label competitor, and evaluates whether moving the
  aligned \code{bs x bs} block from region A to region B increases a histogram
  score. If beneficial, all pixels of label A inside that block are reassigned.
  \item \strong{Determinism:} the sampler uses a deterministic RNG in C++,
  yielding reproducible results given the same inputs and parameters.
}

\strong{Missing values:} unlike other segmenters in \pkg{rsegm}, this SEEDS
implementation does not explicitly mask \code{NA} pixels. Pixels with
\code{NA}/NaN do not contribute to histograms, but still receive a label.
Consider pre-filling or masking if \code{NA} regions should be excluded.
}
\examples{
\dontrun{
library(terra)
r <- terra::rast(sample_raster_path())

spx <- seeds_segmenter(
  r,
  step = 12,
  nbins = 20,
  block_sizes = c(8, 4, 2, 1),
  iters_per_level = 5,
  boundary_samples = 8,
  alpha = 1.0,
  verbose = TRUE
)
plot(spx)
}

}
\seealso{
\code{\link{baatz_segmenter}}, \code{\link{fh_segmenter}},
  \code{\link{meanshift_segmenter}}
}
